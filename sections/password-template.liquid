{% assign desktopClasses = 'hidden xl:block' %}
{% assign mobileClasses = '' %}

{% if section.settings.mobile_bg or section.settings.mobile_bg_video %}
  {% assign desktopClasses = 'hidden xl:block' %}
{% endif %}

{% if section.settings.desktop_bg or section.settings.desktop_bg_video %}
  {% assign mobileClasses = 'xl:hidden' %}
{% endif %}

<style>
  {% unless section.settings.show_header %}
    #masthead { display: none; }
  {% endunless %}

  {% unless section.settings.show_header_menu %}
    #menu-drawer-button { display: none; }
  {% endunless %}

  {% unless section.settings.show_header_logo %}
    #masthead svg { display: none; }
  {% endunless %}

  {% unless section.settings.show_header_cart %}
    #masthead .w-8 > a { display: none; }
  {% endunless %}
</style>

<section class="fixed w-screen h-[100dvh] lg:h-screen flex justify-center items-center bg-white" style="z-index:999">
  <div class="absolute top-0 left-0 w-full h-full">
    {% if section.settings.mobile_bg %}
      <div class="h-full w-full object-cover {{ mobileClasses }}">
        {{ section.settings.mobile_bg | image_url: width: 1024 | image_tag: class: 'h-full w-full object-cover' }}
      </div>
    {% endif %}

    {% if section.settings.mobile_bg_video %}
      <video
        id="mobile-video"
        class="w-full h-full object-cover {{ mobileClasses }}"
        autoplay muted loop playsinline preload="auto"
        style="pointer-events: none;"
      >
        <source src="{{ section.settings.mobile_bg_video }}" type="video/mp4">
      </video>
    {% endif %}

    {% if section.settings.desktop_bg %}
      <div class="h-full w-full object-cover {{ desktopClasses }}">
        {{ section.settings.desktop_bg | image_url: width: 1920 | image_tag: class: 'h-full w-full object-cover' }}
      </div>
    {% endif %}

    {% if section.settings.desktop_bg_video %}
      <video
        id="desktop-video"
        class="w-full h-full object-cover {{ desktopClasses }}"
        autoplay muted loop playsinline preload="auto"
        style="pointer-events: none;"
      >
        <source src="{{ section.settings.desktop_bg_video }}" type="video/mp4">
      </video>
    {% endif %}

    {% if section.settings.background_music %}
      <audio
        id="bg-music"
        autoplay
        muted
        loop
        preload="auto"
        style="display: none;"
      >
        <source src="{{ section.settings.background_music }}" type="audio/mpeg">
      </audio>
    {% endif %}
  </div>

  <div class="relative container text-center mb-[140px] xl:mb-0 z-50">
    <div class="text-white mx-auto reveal-fade-in-pwd--delay" style="max-width: {{ section.settings.logo_width }}px;">
      {% if section.settings.show_logo %}
        {% if section.settings.logo %}
          {{ section.settings.logo | image_url: width: 600 | image_tag }}
        {% else %}
          <!-- Default Logo SVG -->
          <svg class="mx-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 117.06 40.28" width="100%">
            <path d="M27.06,11.15,20.44,21.28v7.9H16.72V21.55L9.91,11.15h4.48l4.12,7,4.24-7Z"></path>
            <path d="M34.05,21.07v-1.9c0-5.34,2.74-8,8.58-8s8.58,2.66,8.58,8v1.9c0,5.44-2.74,8.1-8.58,8.1S34.05,26.51,34.05,21.07Zm13.4-.14v-1.6c0-3.55-1.61-4.92-4.82-4.92s-4.82,1.37-4.82,4.92v1.6c0,3.61,1.61,5,4.82,5S47.45,24.54,47.45,20.93Z"></path>
            <path d="M59,23.29v-.11h3.38v.08c0,1.92,1.55,2.94,4.36,2.94,2.57,0,3.86-.63,3.86-2.2V24c0-1.4-1-1.89-2.81-2.1l-2.52-.29c-3.65-.42-6-1.74-6-5.38v-.06c0-3.09,2.21-5,7.25-5s7.19,2.29,7.19,5.57v.15H70.23v-.1c0-1.73-1.34-2.65-3.88-2.65s-3.6.6-3.62,1.94v.05c0,1.39,1,1.92,3.09,2.21l2.86.31c3.13.37,5.41,1.76,5.44,5.07v.1c0,3.6-2.57,5.36-7.43,5.36C61,29.17,59,26.68,59,23.29Z"></path>
            <path d="M104.88,29.17v-18h3.7v18Z"></path>
            <path d="M81.27,23.29v-.11h3.38v.08c0,1.92,1.55,2.94,4.36,2.94,2.57,0,3.86-.63,3.86-2.2V24c0-1.4-1.05-1.89-2.81-2.1l-2.52-.29c-3.65-.42-6-1.74-6-5.38v-.06c0-3.09,2.21-5,7.25-5s7.19,2.29,7.19,5.57v.15H92.56v-.1c0-1.73-1.34-2.65-3.89-2.65s-3.6.6-3.62,1.94v.05c0,1.39,1,1.92,3.1,2.21l2.86.31c3.12.37,5.4,1.76,5.43,5.07v.1c0,3.6-2.57,5.36-7.43,5.36C83.34,29.17,81.27,26.68,81.27,23.29Z"></path>
          </svg>
        {% endif %}
      {% endif %}
    </div>

    <div class="absolute top-12 left-1/2 -translate-x-1/2 reveal-fade-in-pwd">
      <div class="absolute left-1/2 -translate-x-1/2">
        <a
          href="/pages/yossi-corp-homepage"
          class="button--system min-w-[100px] text-xs text-center"
          style="display: inline-block;"
          onclick="unmuteVideos();"
        >
          <span class="button--inner">Enter</span>
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  function unmuteVideos() {
    const desktopVideo = document.getElementById('desktop-video');
    const mobileVideo = document.getElementById('mobile-video');
    const bgMusic = document.getElementById('bg-music');

    if (desktopVideo) {
      desktopVideo.muted = false;
      desktopVideo.volume = 1;
    }
    if (mobileVideo) {
      mobileVideo.muted = false;
      mobileVideo.volume = 1;
    }
    if (bgMusic) {
      bgMusic.muted = false;
      bgMusic.volume = 1;
      bgMusic.play().catch(() => {});
    }
  }

  function enableAudioOnScrollOrClick() {
    const bgMusic = document.getElementById('bg-music');
    if (bgMusic && bgMusic.muted) {
      bgMusic.muted = false;
      bgMusic.play().catch(() => {});
      window.removeEventListener('scroll', enableAudioOnScrollOrClick);
      window.removeEventListener('click', enableAudioOnScrollOrClick);
      window.removeEventListener('touchstart', enableAudioOnScrollOrClick);
    }
  }

  window.addEventListener('scroll', enableAudioOnScrollOrClick);
  window.addEventListener('click', enableAudioOnScrollOrClick);
  window.addEventListener('touchstart', enableAudioOnScrollOrClick);
</script>

{% schema %}
{
  "name": "Enter Page Redirect",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "logo_width",
      "label": "Logo Width (px)",
      "default": 120,
      "min": 40,
      "max": 300,
      "step": 5
    },
    { "type": "checkbox", "id": "show_logo", "label": "Show Logo", "default": true },
    { "type": "checkbox", "id": "show_header", "label": "Show Header", "default": false },
    { "type": "checkbox", "id": "show_header_menu", "label": "Show Header Menu", "default": false },
    { "type": "checkbox", "id": "show_header_logo", "label": "Show Header Logo", "default": false },
    { "type": "checkbox", "id": "show_header_cart", "label": "Show Header Cart", "default": false },
    { "type": "image_picker", "id": "logo", "label": "Logo" },
    { "type": "image_picker", "id": "desktop_bg", "label": "Desktop BG" },
    { "type": "url", "id": "desktop_bg_video", "label": "Desktop BG Video" },
    { "type": "image_picker", "id": "mobile_bg", "label": "Mobile BG" },
    { "type": "url", "id": "mobile_bg_video", "label": "Mobile BG Video" },
    {
      "type": "url",
      "id": "background_music",
      "label": "Background Music MP3"
    }
  ],
  "presets": [
    { "name": "Enter Page Redirect" }
  ]
}
{% endschema %}
